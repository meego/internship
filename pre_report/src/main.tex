%!TEX TS-program = xelatex
%!TEX encoding = UTF-8 Unicode

\documentclass[twoside]{report}

%% LANGUAGE (english by default)
\def\mlanguage french % TODO: remove this and use a cli parameter
\usepackage{iflang}
\ifx\mlanguage\undefined
  \usepackage[frenchb, english]{babel}
  \selectlanguage{english}
\else
  \usepackage[english, frenchb]{babel}
  \selectlanguage{frenchb}
\fi
\newcommand{\ifr}[2]{\iflanguage{frenchb}{#1}{#2}}

%% PACKAGES %%
\usepackage[top=3cm,bottom=2.7cm,left=2.3cm,right=2.3cm]{geometry}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{url}
\usepackage{pdfpages}
\usepackage{graphicx}
\usepackage{placeins}
\usepackage{subcaption}
\usepackage{multirow}
\usepackage{lscape}
\usepackage{setspace}
\usepackage{titlesec}
\usepackage{sectsty}
\usepackage{placeins}
\usepackage{amsmath,amsfonts,amsthm}
\usepackage[hidelinks]{hyperref}
\usepackage[official]{eurosym}
\usepackage{fancyhdr}
\usepackage[sort, authoryear]{natbib}
\usepackage{paralist} %% enumerate several elements on a single line like (i)
%% this is an example, (ii) this is a second example

%% TITLE PAGE
\title{
\normalfont \normalsize
\textsc{Université Pierre et Marie Curie} \\ [25pt]
\horrule{0.5pt} \\[0.4cm]
\huge Pré-rapport de stage\\
\horrule{2pt} \\[0.5cm]
}
\author{Pierre-Yves PÉNEAU}
\date{\normalsize\today}

%% HEADER / FOOTER
%% \pagestyle{fancy}
\fancyhead{}
\fancyfoot{}

\fancyhead[CO,CE]{Pré-rapport de stage}
\fancyhead[LH]{Université Pierre \& Marie Curie}
\fancyhead[RH]{Pierre-Yves PÉNEAU}
\fancyfoot[C]{Draft version}
\fancyfoot[RO, LE] {\thepage}

%% COMMANDS
\newcommand{\todo}[1]{\textbf{\color{red}TODO: #1}}
\newcommand{\benumline}{\begin{inparaenum}[\itshape i\upshape)]}
\newcommand{\eenumline}{\end{inparaenum}}
\setlength\parindent{0pt}
\titlespacing*{\chapter}{0pt}{0pt}{20pt}
\titleformat{\chapter}[hang]{\bf\huge}{\thechapter}{2pc}{}
\newcommand{\horrule}[1]{\rule{\linewidth}{#1}}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}
\bibpunct{[}{]}{,}{n}{,}{,}
%% 1/ The symbol for the opening bracket.
%% 2/ The symbol for the closing bracket.

%% 3/ The symbol that appears between multiple citations.
%%      This argument takes a letter:
%%       n - numerical style.
%%       s - numerical superscript style.
%%       any other letter - author-year style.

%% 4/ The punctuation to appear between the author and the year (in
%% parenthetical case only).

%% 5/ The punctuation used between years, in multiple citations when there is a
%% common author. e.g., (Chomsky 1956, 1957). If you want an extra space, then
%% you need {,~}.

%% Misc
\graphicspath{{include/img/},{include/pdf/}}
\DeclareGraphicsExtensions{.jpeg,.jpg,.png}

\begin{document}

  \input{src/titlepage-fr}
  \newpage
  \thispagestyle{empty}
  \mbox{}

  \setcounter{page}{1}
  \pagenumbering{roman}
  \pagestyle{headings}
  \onehalfspacing

  \listoffigures
  \newpage
  \thispagestyle{plain}
  \mbox{}
  \listoftables
  \newpage
  \thispagestyle{plain}
  \mbox{}
  \tableofcontents
  \newpage
  \thispagestyle{plain}
  \mbox{}
  \clearpage

  \setcounter{page}{1}
  \pagenumbering{arabic}
  \pagestyle{fancy}

  %% Redefined fancyplain style. It's used on chapter and titlepage
  \fancypagestyle{plain}{}

  \ifr{ %% FRENCH PART HERE
    \input{src/introduction-fr}
    \input{src/chapter1-fr}
    \input{src/chapter2-fr}
    \input{src/conclusion-fr}
  }
  {
    %% ENGLISH PART HERE
  }


  \clearpage
  %% Redefined header for bib
  \fancypagestyle{plain}{
    \fancyhf{}
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\footrulewidth}{0pt}
    %% \fancyfoot[RO,LE] {\thepage}
  }
  \pagestyle{plain}
  \mbox{}
  \bibliographystyle{plainnat}
  \bibliography{src/references}
  \ifr {\addcontentsline{toc}{chapter}{Bibliographie}}
       {\addcontentsline{toc}{chapter}{References}}

\end{document}
